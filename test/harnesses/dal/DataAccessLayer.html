<!-- file: test/harnesses/dal/DataAccessLayer.html (MODERNIZED) -->
<!DOCTYPE html>
<html lang="en">
<!-- ... (head and style sections are the same) ... -->
<body>

    <div class="main-panel">
        <h1>Test Runner for <code>DataAccessLayer.js</code></h1>
        <button id="run-tests-btn">Run All Tests</button>
        <div id="test-results"></div>
    </div>
    <div class="log-panel">
        <h2>Execution Log</h2>
        <pre id="log-output"></pre>
    </div>

<!-- file: test/harnesses/dal/DataAccessLayer.html -->
<!-- ... -->
    <!-- The magic happens here: We load a single "runner" script as a module -->
    <script type="module">
        // Import all the necessary components for the HARNESS
        import { DataAccessLayer } from '/percussion-studio/src/dal/DataAccessLayer.js';
        import { runDalTests }     from '/percussion-studio/test/suites/dal/DataAccessLayer.test.js';
        import { TestRunner }      from '/percussion-studio/test/lib/TestRunner.js';
        // MockLogger is no longer needed here, the test suite imports it itself.

        // Make ONLY the class being tested available globally for the test suite to access.
        window.DataAccessLayer = DataAccessLayer;

        document.getElementById('run-tests-btn').addEventListener('click', async () => {
            const resultsContainer = document.getElementById('test-results');
            resultsContainer.innerHTML = '<h2>Running tests...</h2>';
            
            // We still need to configure the static properties on MockLogger,
            // so we must import it here too.
            const { MockLogger } = await import('/percussion-studio/test/mocks/MockLogger.js');
            MockLogger.clearLogs();
            MockLogger.setLogTarget('log-output');

            const runner = new TestRunner();
            // runDalTests is async now because our tests are async
            await runDalTests(runner);
            runner.renderResults('test-results');
        });
    </script>
<!-- ... -->
</body>
</html>